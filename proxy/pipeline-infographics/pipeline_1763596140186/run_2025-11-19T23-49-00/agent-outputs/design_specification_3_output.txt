Perfect! Now I have all the context I need to create the plan:

---

**UNDERSTANDING:** User wants me to create a comprehensive plan for building the `bitcoin_daemon_manager` agent based on section 2.1 of the MINING_CYCLE_AUTOMATION_PLAN.md document. The agent needs to manage Bitcoin daemon lifecycle in regtest mode, including installation verification, configuration generation, daemon start/stop operations, RPC status queries, block generation, and wallet management. The agent JSON file must be written to `/mnt/c/github/claudeplus/agents/bitcoin_daemon_manager.json` with specific permissions (Read, Write, Edit, Bash, Glob, Grep) and decision keywords (daemon_started, daemon_stopped, daemon_error, error).

**APPROACH:** I will create a detailed plan for building the bitcoin_daemon_manager agent by:
1. Analyzing the specification in section 2.1 of MINING_CYCLE_AUTOMATION_PLAN.md
2. Examining the existing bitcoin_daemon_manager.json structure from the SuperCoinServ project
3. Reviewing the claudeplus agent pattern (browser_commander.json)
4. Synthesizing requirements into a comprehensive agent definition
5. Planning the agent capabilities, system prompt, tools, and validation criteria
6. Structuring the JSON to match claudeplus agent patterns while incorporating Bitcoin daemon management requirements

**STEPS:**
1. **Read section 2.1 specification** - Already completed, located at lines 115-138 of MINING_CYCLE_AUTOMATION_PLAN.md
2. **Extract required capabilities from specification**:
   - Install/verify bitcoind installation
   - Generate regtest configuration  
   - Start daemon with proper flags
   - Stop daemon gracefully
   - Query daemon status (getblockchaininfo, getnetworkinfo)
   - Generate test blocks (generatetoaddress)
   - Create/fund regtest wallets
3. **Map success criteria from specification** (lines 133-137):
   - Can start daemon from cold state
   - Can generate 101 blocks (mature coinbase)
   - RPC interface responds correctly
   - Clean shutdown with no corruption
4. **Examine existing agent structure** - Review the SuperCoinServ bitcoin_daemon_manager.json for configuration patterns, RPC settings, daemon arguments, health checks
5. **Design agent JSON structure** using claudeplus pattern:
   - `id`: "bitcoin_daemon_manager"
   - `name`: descriptive name
   - `role`: single-line role description
   - `expertise`: array of specialized capabilities
   - `systemPrompt`: comprehensive instructions for daemon management
   - `outputFormat`: "markdown"
   - `validationCriteria`: success criteria from spec
   - `requiredTools`: ["Bash", "Read", "Write", "Edit", "Glob", "Grep"]
   - Additional fields: decisions, configuration details
6. **Structure systemPrompt** to include:
   - Role introduction and purpose
   - Installation verification procedures
   - Configuration file generation (bitcoin.conf for regtest)
   - Daemon lifecycle management (start, stop, restart)
   - RPC connectivity and authentication
   - Status query commands (getblockchaininfo, getnetworkinfo, getblockcount)
   - Block generation commands (generatetoaddress)
   - Wallet operations (createwallet, loadwallet, getnewaddress, getbalance)
   - Error handling and recovery procedures
   - Decision keyword usage (daemon_started, daemon_stopped, daemon_error, error)
7. **Define expertise array** covering:
   - Bitcoin Core daemon management
   - Regtest mode configuration
   - RPC interface operations
   - Wallet management
   - Block generation for testing
   - Process lifecycle control
   - Error detection and recovery
8. **Create validationCriteria** matching success criteria:
   - "Daemon starts successfully from cold state"
   - "Can generate 101+ blocks for mature coinbase"
   - "RPC interface responds to queries correctly"
   - "Clean shutdown with no data corruption"
   - "Wallet creation and funding works correctly"
9. **Add decisions object** with required keywords:
   ```json
   "decisions": ["daemon_started", "daemon_stopped", "daemon_error", "error"]
   ```
10. **Include configuration section** with:
    - Default bitcoind paths
    - Regtest network settings
    - RPC configuration (host, port, username, password)
    - Data directory paths
    - Common daemon arguments
11. **Write complete JSON** to `/mnt/c/github/claudeplus/agents/bitcoin_daemon_manager.json` using Write tool
12. **Validate JSON structure** by reading back the file to ensure proper formatting

**TEST_CONSIDERATIONS:**
The plan will address these test scenarios:
- **Cold start test**: Agent must verify bitcoind installation, generate config if missing, and start daemon from completely stopped state
- **Configuration generation test**: Agent must create valid bitcoin.conf with correct regtest settings, RPC credentials, and ports
- **RPC connectivity test**: Agent must successfully connect to RPC interface using bitcoin-cli or curl, handling authentication
- **Block generation test**: Agent must execute `generatetoaddress 101 <address>` to create mature coinbase transactions
- **Wallet operations test**: Agent must create wallet, generate addresses, check balances, and verify funding
- **Graceful shutdown test**: Agent must use `bitcoin-cli stop` and verify clean daemon termination
- **Error handling test**: Agent must detect and report various errors (port conflicts, authentication failures, already running daemon, RPC timeouts)
- **Status query test**: Agent must successfully call getblockchaininfo, getnetworkinfo, getbalance and parse responses
- **Edge cases**: Handle missing bitcoind, corrupted data directory, network mismatch, insufficient permissions

**EVIDENCE:**
I will collect the following evidence to validate the plan:
1. **Complete agent JSON file** written to `/mnt/c/github/claudeplus/agents/bitcoin_daemon_manager.json`
2. **Specification compliance checklist**:
   - ✓ All 7 capabilities from section 2.1 included in systemPrompt
   - ✓ All 4 success criteria mapped to validationCriteria
   - ✓ Required tools specified (Bash, Read, Write, Edit, Glob, Grep)
   - ✓ All 4 decision keywords defined
3. **JSON structure validation**:
   - ✓ Valid JSON syntax (no parsing errors)
   - ✓ Matches claudeplus agent pattern (id, name, role, expertise, systemPrompt, etc.)
   - ✓ Comprehensive systemPrompt with detailed instructions
   - ✓ All required fields present
4. **File path verification**: Confirm file exists at exact path `/mnt/c/github/claudeplus/agents/bitcoin_daemon_manager.json`
5. **Content verification**: Read back file and verify all sections are present and correctly structured

**CONFIDENCE:** High

**Reasoning for high confidence:**
1. Clear specification in MINING_CYCLE_AUTOMATION_PLAN.md section 2.1 with explicit capabilities and success criteria
2. Existing reference implementation in SuperCoinServ project showing configuration patterns
3. Well-established claudeplus agent pattern from browser_commander.json
4. Straightforward task of synthesizing requirements into JSON structure
5. All required information available (capabilities, tools, decisions, validation criteria)
6. No complex algorithms or uncertain technical challenges - primarily structured data creation
7. Clear validation approach (read file back, check structure, verify compliance with spec)

[DECISION: design_complete]