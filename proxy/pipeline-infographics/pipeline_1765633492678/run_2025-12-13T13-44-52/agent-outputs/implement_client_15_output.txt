## Implemented

Based on the reviewed requirements from the design documents, I implemented the missing companion AI visual feedback systems:

### 1. Companion Attack Animations (`Companion.ts`)
- **Melee animations**: Wind-up → swing → recovery cycle with body rotation and position changes
- **Ranged animations**: Recoil animation with kickback effect
- Different animation types based on companion role/class (Tau Fire Warriors and Guardsmen get ranged, Orks get melee)

### 2. Companion Action Indicators (`Companion.ts`)
- Floating skill name banners above companion heads when using abilities
- Role-colored borders (Tank=gold, Healer=green, DPS=red, Support=blue, Control=purple)
- Auto-fade after 1.5 seconds

### 3. Visual Damage/Heal Feedback (`Companion.ts`)
- `flashDamage()`: Red emissive flash when taking damage (150ms)
- `flashHeal()`: Green emissive flash when healing (300ms)
- Automatically triggered on `takeDamage()` calls

### 4. Formation System (`PartyManager.ts`)
- V-formation positioning: Companions spread behind player in left/center/right positions
- Role-based slot assignment: Healers prefer center-back, Tanks/DPS prefer flanks
- Dynamic formation recalculation when party composition changes

### 5. CombatManager Integration (`CombatManager.ts`)
- `showActionIndicator()` called when companion uses any skill
- `playAttackAnimation()` triggered for enemy-targeted skills
- `flashHeal()` called when companions heal themselves or allies

## Design Compliance

| Requirement (from companions-design.md) | Implementation |
|---|---|
| "Companions make visible combat decisions" | Action indicators show skill names above heads |
| "Visual feedback when using skills" | Attack animations (melee swing/ranged recoil) |
| "Health/damage feedback" | Red flash on damage, green flash on heal |
| "Follow player = 200 range" (Line 757) | Formation positions calculated relative to player |
| "Role-specific positioning" | Healers center-back, Tanks/DPS on flanks |
| "70%/90% effectiveness" | Already implemented in skill damage calculation |

## Files Modified

1. **`client/src/game/companions/Companion.ts`**
   - Added attack animation system (`playAttackAnimation()`, `updateAttackAnimation()`)
   - Added action indicator sprites (`showActionIndicator()`)
   - Added damage/heal flash effects (`flashDamage()`, `flashHeal()`)
   - Enhanced `update()` loop to process animations

2. **`client/src/combat/CombatManager.ts`**
   - Added `showActionIndicator()` calls in `executeCompanionSkill()`
   - Added `playAttackAnimation()` calls for enemy-targeted skills
   - Added `flashHeal()` calls in heal handling

3. **`client/src/game/companions/PartyManager.ts`**
   - Added `FORMATION_OFFSETS` configuration
   - Added `ROLE_FORMATION_PREFERENCE` mapping
   - Added `getFormationPosition()` for V-formation calculation
   - Added `optimizeFormationSlots()` for role-based slot assignment
   - Updated `FOLLOW` action to use formation positions instead of exact player position

## How to Test

1. Start the game client with companions in party
2. Engage enemies in combat
3. Observe:
   - **Skill names** appear above companion heads when they act
   - **Attack animations** play (melee swing or ranged recoil)
   - **Damage flash** (red) when companions take hits
   - **Heal flash** (green) when companions receive healing
   - **Formation** spreads companions in V-shape behind player
4. Verify companions no longer "just stand there" - they actively animate, show actions, and maintain formation

DECISION: client_only