Perfect! Now I have all the information needed. Let me create the plan.

---

## PLAN FOR MINER_MANAGER AGENT

**UNDERSTANDING**: User wants to create a miner_manager agent following section 2.1 of MINING_CYCLE_AUTOMATION_PLAN.md. This agent should configure and run mining software (like cpuminer), manage miner installation/verification, generate miner configuration, create/import wallet for rewards, start miner with pool connection, monitor hashrate and submissions, and stop miner gracefully. The agent JSON should be written to `/mnt/c/github/claudeplus/agents/miner_manager.json` and needs to follow the pattern of existing agents like bitcoin_daemon_manager.json.

**APPROACH**: 
1. Analyze the specification in section 2.1 of MINING_CYCLE_AUTOMATION_PLAN.md (lines 165-186)
2. Use bitcoin_daemon_manager.json as structural template since it's a comprehensive infrastructure agent
3. Map the specified capabilities to agent configuration following the established JSON schema pattern
4. Create complete agent JSON with proper sections: configuration, responsibilities, inputs/outputs, RPC endpoints, dependencies, error handling, logging, metrics, and validation
5. Adapt the structure to miner-specific requirements (cpuminer, stratum connection, hashrate monitoring)

**STEPS**:
1. Read section 2.1 specification again for exact requirements (lines 165-186 of MINING_CYCLE_AUTOMATION_PLAN.md)
2. Identify all required capabilities from spec:
   - Install/verify cpuminer (or other miner)
   - Generate miner configuration
   - Create/import wallet for rewards
   - Start miner with pool connection
   - Monitor hashrate and submissions
   - Stop miner gracefully
3. Map success criteria from spec (lines 181-185)
4. Design agent JSON structure with these sections:
   - `agent_name`: "miner_manager"
   - `agent_type`: "infrastructure_core" (similar to bitcoin_daemon_manager)
   - `group`: 1 (infrastructure group)
   - `version`: "1.0.0"
   - `description`: Per specification
   - `configuration`: Miner paths, pool connection settings, monitoring intervals
   - `responsibilities`: All 6 capabilities from spec
   - `inputs`: Commands (start, stop, status, getHashrate, etc.) and events
   - `outputs`: Events (miner_started, miner_stopped, miner_error, share_submitted, etc.) and status fields
   - `rpc_endpoints`: REST API for miner control
   - `dependencies`: pool_server_manager, wallet_manager
   - `error_handling`: Connection failures, miner crashes, invalid shares
   - `logging`: Miner lifecycle, hashrate, share submissions
   - `metrics`: Hashrate, shares submitted/accepted, uptime
   - `validation`: Required configuration fields
5. Create JSON content with all sections properly formatted
6. Write JSON to `/mnt/c/github/claudeplus/agents/miner_manager.json`
7. Verify JSON is valid and properly formatted

**TEST_CONSIDERATIONS**:
- **Installation Verification**: Agent should check if cpuminer exists at specified path, attempt installation if missing, and verify successful installation
- **Configuration Generation**: Agent should generate valid miner command-line arguments with pool URL, worker credentials, and algorithm
- **Wallet Integration**: Agent should coordinate with wallet_manager to get/create mining reward address
- **Pool Connection**: Agent should verify pool is accessible before starting miner, handle connection failures gracefully
- **Hashrate Monitoring**: Agent should parse miner stdout/stderr for hashrate metrics and report them via metrics
- **Share Submission Tracking**: Agent should monitor miner logs for share submission/acceptance events
- **Graceful Shutdown**: Agent should send proper termination signals to miner process and wait for clean exit
- **Error Recovery**: Agent should handle miner crashes, pool disconnections, and network issues with proper error events
- **Decision Outputs**: Agent must emit exactly the 4 specified decisions: miner_started, miner_stopped, miner_error, error

**EVIDENCE**:
- Complete JSON file at `/mnt/c/github/claudeplus/agents/miner_manager.json`
- JSON will include all sections from bitcoin_daemon_manager template:
  - Configuration with miner paths, pool settings, monitoring intervals
  - All 6 responsibilities from spec
  - Input commands and events
  - Output events matching the 4 required decisions plus additional monitoring events
  - RPC endpoints for miner control (start/stop/status/hashrate)
  - Dependencies on pool_server_manager and wallet_manager
  - Error handling for connection failures, crashes, invalid shares
  - Logging configuration for miner lifecycle and performance
  - Metrics for hashrate, shares, uptime
  - Validation rules for required fields
- JSON will be valid and properly formatted
- Agent design will align with section 2.1 success criteria (lines 181-185)

**CONFIDENCE**: High - I have clear specification from MINING_CYCLE_AUTOMATION_PLAN.md section 2.1, excellent template from bitcoin_daemon_manager.json, and clear understanding of miner management requirements. The JSON schema pattern is well-established in existing agents. The success criteria are explicit and testable.

[DECISION: design_complete]

DECISION: design_complete