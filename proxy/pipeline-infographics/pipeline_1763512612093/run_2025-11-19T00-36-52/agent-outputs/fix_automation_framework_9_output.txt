Excellent! The fix is now in place. Let me create a summary document explaining what was fixed:

## Framework Fix Summary

**Problem Identified:**
The test script `test_active_mission_craft_equip_bug.js` had a timing issue where:
1. Step 4 (`startCraftingJob`) stores the `jobId` in `evidence.craftingJobId` during its verify callback
2. Step 5 (`completeCraftingJob`) tried to use `evidence.craftingJobId` as a parameter
3. However, the params object was evaluated when the scenario array was defined (before any commands ran), so `evidence.craftingJobId` was `undefined`

**Root Cause:**
The `sendCmd` function didn't support dynamic parameter evaluation, and the params were static objects created at scenario definition time.

**Solution Applied:**
1. **Updated `sendCmd` function** (lines 389-403):
   - Added support for params as a function
   - Pattern: `const actualParams = typeof params === 'function' ? params() : params;`
   - This allows params to be evaluated at command execution time

2. **Changed `completeCraftingJob` params** (line 159):
   - From: `params: { jobId: evidence.craftingJobId }`
   - To: `params: () => ({ jobId: evidence.craftingJobId })`
   - Now the jobId is looked up when the command executes, not when the scenario is defined

**Expected Outcome:**
The test should now:
- ✅ Successfully complete step 4 and store the jobId
- ✅ Successfully execute step 5 with the correct jobId parameter
- ✅ Continue through all remaining steps to test the actual mission bug

**Next Step:**
Retry the reproduction test to verify the framework fix works and to test the actual game bug.

---

**DECISION: framework_fixed_retry_reproduction**