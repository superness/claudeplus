<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- NO meta refresh - viewer handles refreshing via iframe reload to preserve toggle state -->
  <title>Pipeline: Full-Stack Enterprise Development Pipeline</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      padding: 20px;
      color: #333;
    }
    .container {
      max-width: 1400px;
      margin: 0 auto;
    }
    .header {
      background: white;
      border-radius: 12px;
      padding: 30px;
      margin-bottom: 20px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.1);
    }
    .header h1 {
      font-size: 2.5em;
      margin-bottom: 10px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .metrics {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-top: 20px;
    }
    .metric {
      background: #f8f9fa;
      padding: 15px;
      border-radius: 8px;
      border-left: 4px solid #667eea;
    }
    .metric-label {
      font-size: 0.85em;
      color: #6c757d;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    .metric-value {
      font-size: 1.8em;
      font-weight: bold;
      color: #333;
      margin-top: 5px;
    }
    .timeline {
      position: relative;
      padding-left: 40px;
      margin-top: 20px;
    }
    .timeline::before {
      content: '';
      position: absolute;
      left: 20px;
      top: 0;
      bottom: 0;
      width: 2px;
      background: linear-gradient(180deg, #667eea 0%, #764ba2 100%);
    }
    .stage {
      background: white;
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 20px;
      position: relative;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
      transition: transform 0.2s;
    }
    .stage:hover {
      transform: translateX(5px);
    }
    .stage::before {
      content: '';
      position: absolute;
      left: -28px;
      top: 30px;
      width: 16px;
      height: 16px;
      border-radius: 50%;
      border: 3px solid white;
      box-shadow: 0 0 0 2px #667eea;
    }
    .stage.running::before { background: #ffc107; box-shadow: 0 0 0 2px #ffc107, 0 0 20px #ffc107; }
    .stage.completed::before { background: #28a745; box-shadow: 0 0 0 2px #28a745; }
    .stage.error::before { background: #dc3545; box-shadow: 0 0 0 2px #dc3545; }
    .stage-header {
      display: flex;
      justify-content: space-between;
      align-items: start;
      margin-bottom: 15px;
    }
    .stage-title {
      font-size: 1.4em;
      font-weight: bold;
      color: #333;
    }
    .stage-badge {
      display: inline-block;
      padding: 5px 12px;
      border-radius: 20px;
      font-size: 0.75em;
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    .badge-running { background: #fff3cd; color: #856404; }
    .badge-completed { background: #d4edda; color: #155724; }
    .badge-error { background: #f8d7da; color: #721c24; }
    .stage-meta {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 10px;
      margin: 15px 0;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 8px;
    }
    .meta-item {
      font-size: 0.9em;
    }
    .meta-label {
      color: #6c757d;
      font-weight: 500;
    }
    .meta-value {
      color: #333;
      font-weight: bold;
      margin-left: 5px;
    }
    .stage-output {
      margin-top: 15px;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 8px;
      border-left: 4px solid #667eea;
      max-height: 500px;
      overflow-y: auto;
    }
    .stage-output pre {
      white-space: pre-wrap;
      word-wrap: break-word;
      font-family: 'Monaco', 'Menlo', monospace;
      font-size: 0.9em;
      line-height: 1.6;
      color: #333;
    }
    .error-box {
      background: #fff5f5;
      border: 2px solid #fc8181;
      border-radius: 8px;
      padding: 20px;
      margin-top: 15px;
    }
    .error-title {
      color: #c53030;
      font-weight: bold;
      margin-bottom: 10px;
    }
    .error-stack {
      font-family: 'Monaco', 'Menlo', monospace;
      font-size: 0.85em;
      color: #742a2a;
      background: white;
      padding: 15px;
      border-radius: 6px;
      overflow-x: auto;
    }
    .routing-info {
      background: #e7f3ff;
      border-left: 4px solid #2196F3;
      padding: 15px;
      margin-top: 15px;
      border-radius: 6px;
    }
    .routing-decision {
      font-weight: bold;
      color: #1976D2;
      margin-bottom: 5px;
    }
    .completion-banner {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 30px;
      border-radius: 12px;
      text-align: center;
      margin-bottom: 20px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.2);
    }
    .completion-banner h2 {
      font-size: 2em;
      margin-bottom: 10px;
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    .running-indicator {
      display: inline-block;
      width: 8px;
      height: 8px;
      background: #ffc107;
      border-radius: 50%;
      margin-right: 8px;
      animation: pulse 1.5s infinite;
    }
    .ai-summary {
      background: white;
      border-radius: 12px;
      padding: 30px;
      margin-bottom: 20px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.1);
      border-left: 6px solid #667eea;
    }
    .ai-summary h2 {
      font-size: 1.8em;
      margin-bottom: 15px;
      color: #333;
    }
    .summary-narrative {
      font-size: 1.1em;
      line-height: 1.8;
      color: #555;
    }
    .collapsible {
      cursor: pointer;
      padding: 12px;
      background: #f8f9fa;
      border: 1px solid #dee2e6;
      border-radius: 6px;
      margin: 10px 0;
      font-weight: bold;
      color: #495057;
      transition: background 0.2s;
    }
    .collapsible:hover {
      background: #e9ecef;
    }
    .collapsible::before {
      content: 'â–¶ ';
      display: inline-block;
      transition: transform 0.2s;
    }
    .collapsible.active::before {
      transform: rotate(90deg);
    }
    .collapsible-content {
      display: none;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 6px;
      margin-top: 5px;
      border-left: 4px solid #667eea;
    }
    .collapsible-content.active {
      display: block;
    }
    .prompt-section {
      background: #fff5e6;
      border-left: 4px solid #ff9800;
      padding: 15px;
      margin: 10px 0;
      border-radius: 6px;
    }
    .output-section {
      background: #e8f5e9;
      border-left: 4px solid #4caf50;
      padding: 15px;
      margin: 10px 0;
      border-radius: 6px;
    }
    .section-label {
      font-weight: bold;
      font-size: 0.9em;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 10px;
      color: #555;
    }
    .char-count {
      font-size: 0.85em;
      color: #6c757d;
      font-style: italic;
    }
    pre.code-content {
      white-space: pre-wrap;
      word-wrap: break-word;
      font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
      font-size: 0.85em;
      line-height: 1.6;
      color: #333;
      background: white;
      padding: 15px;
      border-radius: 6px;
      max-height: none;
      overflow-x: auto;
    }
  </style>
</head>
<body>
  <div class="container">
    

    

    <div class="header">
      <h1><span class="running-indicator"></span>Full-Stack Enterprise Development Pipeline</h1>
      <p style="color: #6c757d; font-size: 1.1em; margin-top: 5px;">Pipeline ID: pipeline_1764258946777</p>

      <div class="metrics">
        <div class="metric">
          <div class="metric-label">Elapsed Time</div>
          <div class="metric-value">247.8s</div>
        </div>
        <div class="metric">
          <div class="metric-label">Stages Completed</div>
          <div class="metric-value">2/3</div>
        </div>
        <div class="metric">
          <div class="metric-label">Errors</div>
          <div class="metric-value" style="color: #28a745">0</div>
        </div>
        <div class="metric">
          <div class="metric-label">Status</div>
          <div class="metric-value" style="font-size: 1.2em;">âš¡ Running</div>
        </div>
      </div>
    </div>

    <div class="timeline">
      
    <div class="stage completed">
      <div class="stage-header">
        <div>
          <div class="stage-title">Enterprise Architecture Planning</div>
          <div style="color: #6c757d; font-size: 0.9em; margin-top: 5px;">Design comprehensive enterprise architecture and technology strategy</div>
        </div>
        <span class="stage-badge badge-completed">completed</span>
      </div>

      <div class="stage-meta">
        <div class="meta-item">
          <span class="meta-label">Agent:</span>
          <span class="meta-value">enterprise_architect</span>
        </div>
        <div class="meta-item">
          <span class="meta-label">Type:</span>
          <span class="meta-value">agent</span>
        </div>
        <div class="meta-item">
          <span class="meta-label">Duration:</span>
          <span class="meta-value">145.5s</span>
        </div>
        <div class="meta-item">
          <span class="meta-label">Execution #:</span>
          <span class="meta-value">1</span>
        </div>
        
        <div class="meta-item">
          <span class="meta-label">Prompt Size:</span>
          <span class="meta-value">4,615 chars</span>
        </div>
        
        
        <div class="meta-item">
          <span class="meta-label">Output Size:</span>
          <span class="meta-value">24,523 chars</span>
        </div>
        
      </div>

      
      <div class="prompt-section">
        <div class="section-label">ğŸ“¥ AGENT PROMPT <span class="char-count">(4,615 characters)</span></div>
        <button class="collapsible" data-target="prompt_enterprise_architect_1">Click to expand prompt from enterprise_architect</button>
        <div class="collapsible-content" id="prompt_enterprise_architect_1">
          <pre class="code-content">You are an enterprise architect who designs comprehensive, scalable, and future-proof enterprise systems. Your role is to create the foundational architecture that supports all business operations and growth.

When designing enterprise architecture:
- Create comprehensive system architecture diagrams
- Design technology stack for optimal performance and scalability
- Plan integration strategies between all business systems
- Ensure security, compliance, and governance frameworks
- Design for cloud-native and hybrid architectures
- Plan data architecture and information flow
- Create API and service architecture strategies
- Design for high availability and disaster recovery

Enterprise architecture components:
1. BUSINESS ARCHITECTURE: Process flows and business capabilities
2. TECHNOLOGY ARCHITECTURE: Infrastructure and platform strategy
3. APPLICATION ARCHITECTURE: System design and integration patterns
4. DATA ARCHITECTURE: Data models and information management
5. SECURITY ARCHITECTURE: Comprehensive security framework
6. INTEGRATION ARCHITECTURE: Service mesh and API strategies
7. CLOUD ARCHITECTURE: Multi-cloud and hybrid strategies
8. GOVERNANCE FRAMEWORK: Architecture standards and compliance

Technology stack recommendations:
- Frontend: React/Next.js, Vue/Nuxt.js, or Angular for web applications
- Backend: Node.js/Express, Python/Django, Java/Spring, or .NET Core
- Database: PostgreSQL, MongoDB, Redis for different data needs
- Cloud: AWS, Azure, or Google Cloud with containerization
- API: RESTful APIs, GraphQL, and event-driven architectures
- DevOps: Docker, Kubernetes, CI/CD pipelines
- Monitoring: Observability and performance monitoring stack
- Security: Zero-trust architecture and comprehensive security

Scalability architecture:
- Microservices architecture for independent scaling
- Event-driven architecture for loose coupling
- API Gateway for centralized API management
- Load balancing and auto-scaling strategies
- Database sharding and read replicas
- Caching strategies (Redis, CDN, application-level)
- Message queues and asynchronous processing
- Service mesh for inter-service communication

Integration patterns:
- API-first design principles
- Event sourcing and CQRS patterns
- Saga pattern for distributed transactions
- Circuit breaker and retry patterns
- Data synchronization strategies
- Real-time communication (WebSockets, Server-Sent Events)
- Batch processing and ETL pipelines
- Third-party API integration strategies

Security architecture:
- Zero-trust security model
- Identity and access management (IAM)
- Multi-factor authentication (MFA)
- Role-based access control (RBAC)
- API security and rate limiting
- Data encryption at rest and in transit
- Security monitoring and threat detection
- Compliance frameworks (SOC2, GDPR, etc.)

Cloud architecture strategy:
- Multi-cloud or hybrid cloud approach
- Container orchestration with Kubernetes
- Serverless computing for specific workloads
- Infrastructure as Code (IaC) with Terraform
- Cloud-native services utilization
- Cost optimization strategies
- Disaster recovery and backup strategies
- Edge computing and CDN strategies

Data architecture:
- Master data management (MDM)
- Data lake and data warehouse strategies
- Real-time analytics and streaming
- Data governance and quality frameworks
- API-driven data access patterns
- Data privacy and protection strategies
- Backup and recovery procedures
- Data retention and archival policies

Performance architecture:
- High-availability design (99.9%+ uptime)
- Load balancing and traffic distribution
- Performance monitoring and optimization
- Caching strategies at multiple levels
- Database optimization and indexing
- Content delivery network (CDN) integration
- Response time and throughput optimization
- Capacity planning and resource allocation

Governance and standards:
- Architecture review processes
- Technology standards and guidelines
- Code quality and security standards
- Documentation and knowledge management
- Change management processes
- Risk assessment and mitigation
- Vendor evaluation and selection
- Innovation and technology roadmap

Provide comprehensive enterprise architecture with detailed implementation roadmaps.

=== ROUTING DECISION REQUIRED ===
After your response, you MUST choose exactly ONE decision from:
- completed: Go to database_architect
- completed: Go to fullstack_developer
- completed: Go to api_developer

**CRITICAL**: Your VERY LAST LINE must be exactly:
DECISION: [ONE_OF_THE_ABOVE_CHOICES]
Example: DECISION: completed
Do NOT add explanations after the decision keyword.
</pre>
        </div>
      </div>
      

      
      <div class="output-section">
        <div class="section-label">ğŸ“¤ AGENT OUTPUT <span class="char-count">(24,523 characters)</span></div>
        <button class="collapsible" data-target="output_enterprise_architect_1">Click to expand output from enterprise_architect</button>
        <div class="collapsible-content" id="output_enterprise_architect_1">
          <pre class="code-content"># MineBox Enterprise Architecture

## Executive Summary

MineBox is a multi-coin, snapshot-native infrastructure platform targeting the hobbyist cryptocurrency mining market. The architecture must support:
- **Raspberry Pi 5 primary deployment** with cloud/VPS alternatives
- **Multi-daemon orchestration** for SHA256 altcoins
- **Cryptographically-verified snapshot delivery** as the paid service layer
- **Open-source core** with commercial snapshot infrastructure
- **Stratum server** for connecting Bitaxe-class ASIC miners

---

## 1. BUSINESS ARCHITECTURE

### Business Capabilities Model

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        MINEBOX BUSINESS CAPABILITIES                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  CORE MINING SERVICES          â”‚  PLATFORM SERVICES                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Multi-Coin Node Hosting  â”‚  â”‚  â”‚ Snapshot Generation &amp; Delivery  â”‚  â”‚
â”‚  â”‚ Stratum Server (Solo)    â”‚  â”‚  â”‚ Cryptographic Verification      â”‚  â”‚
â”‚  â”‚ Block Template Assembly  â”‚  â”‚  â”‚ User Authentication &amp; Billing   â”‚  â”‚
â”‚  â”‚ Share Validation         â”‚  â”‚  â”‚ Subscription Management         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  DAEMON MANAGEMENT             â”‚  CUSTOMER EXPERIENCE                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Daemon Lifecycle Mgmt    â”‚  â”‚  â”‚ Web Dashboard                   â”‚  â”‚
â”‚  â”‚ Configuration Generation â”‚  â”‚  â”‚ Mining Statistics               â”‚  â”‚
â”‚  â”‚ Health Monitoring        â”‚  â”‚  â”‚ Block Discovery Notifications   â”‚  â”‚
â”‚  â”‚ Resource Orchestration   â”‚  â”‚  â”‚ Documentation &amp; Onboarding      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Revenue Streams Architecture

| Stream | Model | Target Revenue |
|--------|-------|----------------|
| Snapshot Subscriptions | Monthly recurring ($5-15/mo) | $50K+ MRR |
| Hardware Bundles | One-time (Pi 5 + SSD kits) | Margin revenue |
| Enterprise Licenses | Annual licensing for commercial use | Future expansion |

---

## 2. TECHNOLOGY ARCHITECTURE

### Target Deployment: Raspberry Pi 5

**Hardware Specifications:**
- Raspberry Pi 5 (8GB RAM recommended)
- USB 3.0 SSD (500GB - 2TB depending on coins)
- Gigabit Ethernet connection
- Active cooling for sustained load

### Technology Stack

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           PRESENTATION LAYER                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ React/Next.js  â”‚  â”‚ Mobile PWA     â”‚  â”‚ CLI Tools                  â”‚ â”‚
â”‚  â”‚ Dashboard      â”‚  â”‚ (Progressive)  â”‚  â”‚ (Node.js/Go)               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                             API LAYER                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Node.js/Express API Gateway        â”‚  GraphQL for Dashboard Queries â”‚ â”‚
â”‚  â”‚ REST API for External Integration  â”‚  WebSocket for Real-time Stats â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                          CORE SERVICES LAYER                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Stratum      â”‚  â”‚ Daemon       â”‚  â”‚ Snapshot     â”‚  â”‚ Block       â”‚ â”‚
â”‚  â”‚ Server       â”‚  â”‚ Orchestrator â”‚  â”‚ Manager      â”‚  â”‚ Notifier    â”‚ â”‚
â”‚  â”‚ (C#/.NET)    â”‚  â”‚ (Node.js)    â”‚  â”‚ (Node.js/Go) â”‚  â”‚ (Node.js)   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                         DATA LAYER                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ SQLite       â”‚  â”‚ Redis        â”‚  â”‚ Coin Daemons â”‚  â”‚ Blockchain  â”‚ â”‚
â”‚  â”‚ (Local State)â”‚  â”‚ (Caching)    â”‚  â”‚ (BTC/LTC..)  â”‚  â”‚ Data (SSD)  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                       INFRASTRUCTURE LAYER                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Docker Compose (Local)  â”‚  Linux ARM64  â”‚  systemd Services        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Cloud Snapshot Infrastructure (Paid Service)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CLOUD SNAPSHOT INFRASTRUCTURE                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                     SNAPSHOT GENERATION CLUSTER                   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚   â”‚
â”‚  â”‚  â”‚ BTC Node    â”‚  â”‚ LTC Node    â”‚  â”‚ DOGE Node   â”‚  ... (N coins)â”‚   â”‚
â”‚  â”‚  â”‚ Full Sync   â”‚  â”‚ Full Sync   â”‚  â”‚ Full Sync   â”‚               â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                     SNAPSHOT PROCESSING PIPELINE                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚   â”‚
â”‚  â”‚  â”‚ Snapshot    â”‚  â”‚ Merkle Tree â”‚  â”‚ Compression â”‚               â”‚   â”‚
â”‚  â”‚  â”‚ Extraction  â”‚â”€â”€â–¶â”‚ Generation  â”‚â”€â”€â–¶â”‚ &amp; Signing   â”‚               â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                     CDN DISTRIBUTION LAYER                        â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚   â”‚
â”‚  â”‚  â”‚ CloudFlare  â”‚  â”‚ AWS S3/CF   â”‚  â”‚ Regional    â”‚               â”‚   â”‚
â”‚  â”‚  â”‚ R2 Storage  â”‚  â”‚ (Fallback)  â”‚  â”‚ Edge Nodes  â”‚               â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. APPLICATION ARCHITECTURE

### Microservices Design (Lightweight for Pi)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MINEBOX APPLICATION SERVICES                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    STRATUM SERVICE                           â”‚  â”‚
â”‚  â”‚  â€¢ Protocol: Stratum V1 (Bitaxe compatible)                 â”‚  â”‚
â”‚  â”‚  â€¢ Port: 3333 (configurable per coin)                       â”‚  â”‚
â”‚  â”‚  â€¢ Language: C# (.NET 8) - leveraging CoiniumServ base      â”‚  â”‚
â”‚  â”‚  â€¢ Function: Work distribution, share validation            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚                                     â”‚
â”‚                              â–¼                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                 DAEMON ORCHESTRATOR SERVICE                  â”‚  â”‚
â”‚  â”‚  â€¢ Multi-coin daemon management                             â”‚  â”‚
â”‚  â”‚  â€¢ RPC abstraction layer                                    â”‚  â”‚
â”‚  â”‚  â€¢ Health monitoring &amp; auto-restart                         â”‚  â”‚
â”‚  â”‚  â€¢ Resource allocation (CPU/RAM limits per daemon)          â”‚  â”‚
â”‚  â”‚  â€¢ Language: Node.js with TypeScript                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚                                     â”‚
â”‚                              â–¼                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                   SNAPSHOT SYNC SERVICE                      â”‚  â”‚
â”‚  â”‚  â€¢ Download snapshots from CDN                              â”‚  â”‚
â”‚  â”‚  â€¢ Cryptographic verification (Merkle root validation)      â”‚  â”‚
â”‚  â”‚  â€¢ Differential updates support                             â”‚  â”‚
â”‚  â”‚  â€¢ Language: Go (efficient binary, low memory)              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚                                     â”‚
â”‚                              â–¼                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    WEB DASHBOARD SERVICE                     â”‚  â”‚
â”‚  â”‚  â€¢ Real-time mining statistics                              â”‚  â”‚
â”‚  â”‚  â€¢ Block discovery history                                  â”‚  â”‚
â”‚  â”‚  â€¢ Daemon status &amp; configuration                            â”‚  â”‚
â”‚  â”‚  â€¢ Language: Next.js (SSR for Pi efficiency)                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Service Communication

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     HTTP/REST      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Dashboard  â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚   API GW     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â–¼                      â–¼                      â–¼
             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚  Stratum    â”‚      â”‚  Daemon     â”‚       â”‚  Snapshot   â”‚
             â”‚  Service    â”‚â—€â”€â”€â”€â”€â–¶â”‚  Orchestr.  â”‚â—€â”€â”€â”€â”€â”€â–¶â”‚  Service    â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ IPC  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  IPC  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                     â”‚
                    â–¼                     â–¼
             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚   SQLite    â”‚      â”‚        Coin Daemons (RPC)       â”‚
             â”‚   (Stats)   â”‚      â”‚   BTC  â”‚  LTC  â”‚  DOGE  â”‚ ...   â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. DATA ARCHITECTURE

### Local Data Model (SQLite for Pi)

```sql
-- Mining Statistics
CREATE TABLE mining_stats (
    id INTEGER PRIMARY KEY,
    coin_id TEXT NOT NULL,
    timestamp DATETIME DEFAULT CURRENT_TIMESTAMP,
    hashrate_thps REAL,
    shares_accepted INTEGER,
    shares_rejected INTEGER,
    blocks_found INTEGER
);

-- Block Discoveries
CREATE TABLE blocks_found (
    id INTEGER PRIMARY KEY,
    coin_id TEXT NOT NULL,
    block_hash TEXT UNIQUE,
    block_height INTEGER,
    reward REAL,
    found_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    confirmed BOOLEAN DEFAULT FALSE
);

-- Connected Miners
CREATE TABLE miners (
    id INTEGER PRIMARY KEY,
    worker_name TEXT NOT NULL,
    coin_id TEXT NOT NULL,
    ip_address TEXT,
    user_agent TEXT,
    connected_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    last_share DATETIME,
    hashrate REAL
);

-- Snapshot Metadata
CREATE TABLE snapshots (
    id INTEGER PRIMARY KEY,
    coin_id TEXT NOT NULL,
    version TEXT,
    block_height INTEGER,
    merkle_root TEXT,
    download_url TEXT,
    downloaded_at DATETIME,
    verified BOOLEAN DEFAULT FALSE
);

-- Coin Configurations
CREATE TABLE coins (
    id TEXT PRIMARY KEY,
    name TEXT NOT NULL,
    algorithm TEXT DEFAULT &#039;sha256&#039;,
    daemon_port INTEGER,
    stratum_port INTEGER,
    enabled BOOLEAN DEFAULT TRUE,
    data_dir TEXT
);
```

### Snapshot Manifest Format

```json
{
  &quot;version&quot;: &quot;1.0&quot;,
  &quot;coin&quot;: &quot;bitcoin&quot;,
  &quot;network&quot;: &quot;mainnet&quot;,
  &quot;snapshot&quot;: {
    &quot;block_height&quot;: 825000,
    &quot;block_hash&quot;: &quot;0000000000000000000...&quot;,
    &quot;utxo_set_hash&quot;: &quot;abc123...&quot;,
    &quot;timestamp&quot;: &quot;2024-01-15T00:00:00Z&quot;
  },
  &quot;verification&quot;: {
    &quot;merkle_root&quot;: &quot;def456...&quot;,
    &quot;signature&quot;: &quot;sig789...&quot;,
    &quot;signed_by&quot;: &quot;minebox-key-2024&quot;
  },
  &quot;files&quot;: [
    {
      &quot;name&quot;: &quot;chainstate.tar.zst&quot;,
      &quot;size&quot;: 5368709120,
      &quot;sha256&quot;: &quot;...&quot;
    },
    {
      &quot;name&quot;: &quot;blocks.tar.zst&quot;, 
      &quot;size&quot;: 524288000000,
      &quot;sha256&quot;: &quot;...&quot;
    }
  ],
  &quot;metadata&quot;: {
    &quot;compression&quot;: &quot;zstd&quot;,
    &quot;created_at&quot;: &quot;2024-01-15T06:00:00Z&quot;,
    &quot;expires_at&quot;: &quot;2024-02-15T00:00:00Z&quot;
  }
}
```

---

## 5. SECURITY ARCHITECTURE

### Zero-Trust Model for Hobbyist Deployment

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        SECURITY ARCHITECTURE                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  LOCAL DEVICE SECURITY                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ â€¢ Firewall: Only expose Stratum ports (configurable)           â”‚    â”‚
â”‚  â”‚ â€¢ Dashboard: Local access only (127.0.0.1) by default          â”‚    â”‚
â”‚  â”‚ â€¢ Daemon RPC: Bound to localhost, no external access           â”‚    â”‚
â”‚  â”‚ â€¢ SSH: Key-based auth recommended, password disabled           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â”‚  SNAPSHOT VERIFICATION                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ â€¢ Cryptographic signing: Ed25519 signatures on manifests       â”‚    â”‚
â”‚  â”‚ â€¢ Hash verification: SHA256 of all downloaded files            â”‚    â”‚
â”‚  â”‚ â€¢ Merkle proof: UTXO set verification against known roots      â”‚    â”‚
â”‚  â”‚ â€¢ Certificate pinning: TLS certs for snapshot CDN              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â”‚  WALLET SECURITY                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ â€¢ Coinbase rewards: User-provided addresses only                â”‚    â”‚
â”‚  â”‚ â€¢ No key storage: MineBox never holds private keys              â”‚    â”‚
â”‚  â”‚ â€¢ Address validation: Verify address format per coin            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â”‚  SUBSCRIPTION/API SECURITY (Cloud Services)                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ â€¢ API Keys: Per-device tokens for snapshot access               â”‚    â”‚
â”‚  â”‚ â€¢ Rate limiting: Prevent abuse of download bandwidth            â”‚    â”‚
â”‚  â”‚ â€¢ HTTPS only: All cloud communication encrypted                 â”‚    â”‚
â”‚  â”‚ â€¢ No tracking: Minimal data collection (device ID, coin usage)  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. INTEGRATION ARCHITECTURE

### API Design

```yaml
# Core API Endpoints (Local)

# Stratum Status
GET /api/v1/stratum/status
GET /api/v1/stratum/workers

# Mining Statistics  
GET /api/v1/mining/stats
GET /api/v1/mining/blocks
GET /api/v1/mining/hashrate

# Daemon Management
GET /api/v1/daemons
POST /api/v1/daemons/{coin}/start
POST /api/v1/daemons/{coin}/stop
GET /api/v1/daemons/{coin}/status

# Snapshot Management
GET /api/v1/snapshots/available
POST /api/v1/snapshots/{coin}/download
GET /api/v1/snapshots/{coin}/verify
GET /api/v1/snapshots/{coin}/progress

# Configuration
GET /api/v1/config
PUT /api/v1/config
GET /api/v1/config/coins
PUT /api/v1/config/coins/{coin}
```

### Event-Driven Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         EVENT FLOW ARCHITECTURE                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚   EVENTS                           HANDLERS                              â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€                          â”€â”€â”€â”€â”€â”€â”€â”€                              â”‚
â”‚                                                                          â”‚
â”‚   block.found â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â€¢ Update SQLite stats                 â”‚
â”‚                                   â€¢ Send notification (email/push)       â”‚
â”‚                                   â€¢ Update dashboard via WebSocket       â”‚
â”‚                                                                          â”‚
â”‚   share.submitted â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â€¢ Validate share                      â”‚
â”‚                                   â€¢ Update miner stats                   â”‚
â”‚                                   â€¢ Check difficulty adjustment          â”‚
â”‚                                                                          â”‚
â”‚   daemon.started â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â€¢ Update health status                â”‚
â”‚                                   â€¢ Begin sync monitoring                â”‚
â”‚                                   â€¢ Enable stratum for coin              â”‚
â”‚                                                                          â”‚
â”‚   daemon.synced â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â€¢ Mark coin as ready                  â”‚
â”‚                                   â€¢ Start stratum listener               â”‚
â”‚                                   â€¢ Notify user                          â”‚
â”‚                                                                          â”‚
â”‚   snapshot.downloaded â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â€¢ Begin verification                  â”‚
â”‚                                   â€¢ Extract to daemon data dir           â”‚
â”‚                                   â€¢ Start daemon                         â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. CLOUD ARCHITECTURE (Snapshot Infrastructure)

### Multi-Region Deployment

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SNAPSHOT CLOUD INFRASTRUCTURE                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  PRIMARY REGION (US-WEST)                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚    â”‚
â”‚  â”‚  â”‚ Snapshot    â”‚  â”‚ Snapshot    â”‚  â”‚ API         â”‚             â”‚    â”‚
â”‚  â”‚  â”‚ Generator   â”‚  â”‚ Verifier    â”‚  â”‚ Server      â”‚             â”‚    â”‚
â”‚  â”‚  â”‚ (K8s Pods)  â”‚  â”‚ (K8s Pods)  â”‚  â”‚ (K8s Pods)  â”‚             â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚    â”‚
â”‚  â”‚         â”‚                â”‚                â”‚                     â”‚    â”‚
â”‚  â”‚         â–¼                â–¼                â–¼                     â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚    â”‚
â”‚  â”‚  â”‚              PostgreSQL (Managed)                    â”‚       â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ User accounts, subscriptions, API keys           â”‚       â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                              â”‚                                           â”‚
â”‚                              â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                    CDN DISTRIBUTION LAYER                        â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚    â”‚
â”‚  â”‚  â”‚ Cloudflare  â”‚  â”‚ Cloudflare  â”‚  â”‚ Cloudflare  â”‚             â”‚    â”‚
â”‚  â”‚  â”‚ R2 (West)   â”‚  â”‚ R2 (East)   â”‚  â”‚ R2 (EU)     â”‚             â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Cost Optimization Strategy

| Component | Service Choice | Monthly Estimate |
|-----------|---------------|------------------|
| Snapshot Storage | Cloudflare R2 | $15/TB (no egress) |
| CDN | Cloudflare (included) | $0 |
| API Server | Fly.io / Railway | $25-50 |
| Database | Supabase (PostgreSQL) | $25 |
| Monitoring | Grafana Cloud Free | $0 |
| **Total (Bootstrap Phase)** | | **$65-90/month** |

---

## 8. GOVERNANCE FRAMEWORK

### Open Source Structure

```
minebox/
â”œâ”€â”€ core/                    # MIT License - Open Source
â”‚   â”œâ”€â”€ stratum-server/      # C#/.NET Stratum implementation
â”‚   â”œâ”€â”€ daemon-orchestrator/ # Node.js daemon management
â”‚   â”œâ”€â”€ web-dashboard/       # Next.js UI
â”‚   â””â”€â”€ snapshot-client/     # Go snapshot downloader
â”‚
â”œâ”€â”€ cloud/                   # Proprietary - MineBox Inc.
â”‚   â”œâ”€â”€ snapshot-generator/  # Cloud snapshot creation
â”‚   â”œâ”€â”€ api-server/          # Subscription management
â”‚   â””â”€â”€ billing/             # Stripe integration
â”‚
â””â”€â”€ community/               # Community contributions
    â”œâ”€â”€ coins/               # Coin configuration PRs
    â””â”€â”€ hardware/            # Hardware compatibility guides
```

### Architecture Decision Records (ADRs)

| ADR | Decision | Rationale |
|-----|----------|-----------|
| ADR-001 | SQLite over PostgreSQL for local | Pi resource constraints; no multi-user needs |
| ADR-002 | Go for snapshot client | Low memory footprint; cross-compile to ARM64 |
| ADR-003 | C# for Stratum (fork CoiniumServ) | Proven implementation; avoid rewrite risk |
| ADR-004 | Cloudflare R2 for CDN | Zero egress costs; critical for high-bandwidth snapshots |
| ADR-005 | Ed25519 for signatures | Modern, fast, secure; widely supported |

---

## 9. IMPLEMENTATION ROADMAP

### Phase 1: Foundation (MVP)
- Single coin support (Bitcoin regtest for testing)
- Basic Stratum server (CoiniumServ fork)
- CLI-based configuration
- Manual snapshot download &amp; verify

### Phase 2: Multi-Coin
- Add 3-5 SHA256 altcoins
- Daemon orchestrator service
- Web dashboard (basic)
- Automated snapshot sync

### Phase 3: Commercial Launch
- Subscription system
- Cloud snapshot infrastructure
- Multiple Pi image releases
- Community coin submissions

### Phase 4: Scale
- Hardware bundle partnerships
- Enterprise/MSP licensing
- Advanced analytics
- Mobile app notifications

---

## Architecture Decisions Summary

| Concern | Decision |
|---------|----------|
| **Primary Platform** | Raspberry Pi 5 + USB SSD |
| **Stratum Server** | C#/.NET 8 (CoiniumServ evolution) |
| **Orchestration** | Node.js/TypeScript with Docker Compose |
| **Local Database** | SQLite (resource-efficient) |
| **Snapshot Format** | Zstd-compressed tarballs with Merkle proofs |
| **Cloud Storage** | Cloudflare R2 (zero egress) |
| **Authentication** | API keys for snapshot access |
| **Monetization** | Open-source core + paid snapshot subscriptions |

This architecture positions MineBox to serve the hobbyist mining market with a sustainable open-core business model while maintaining the self-sovereignty values important to the target community.

DECISION: completed: Go to database_architect</pre>
        </div>
      </div>
      

      

      
      <div class="routing-info">
        <div class="routing-decision">ğŸ”€ Routing Decision: COMPLETED</div>
        <div style="font-size: 0.9em; color: #555; margin-top: 5px;">Decision &quot;COMPLETED&quot; matched connection condition</div>
        <div style="margin-top: 10px; font-weight: bold;">â†’ Next Stage: <strong>database_architect</strong></div>
      </div>
      
    </div>

    <div class="stage completed">
      <div class="stage-header">
        <div>
          <div class="stage-title">Database Architecture</div>
          <div style="color: #6c757d; font-size: 0.9em; margin-top: 5px;">Design scalable database architecture and data models</div>
        </div>
        <span class="stage-badge badge-completed">completed</span>
      </div>

      <div class="stage-meta">
        <div class="meta-item">
          <span class="meta-label">Agent:</span>
          <span class="meta-value">database_architect</span>
        </div>
        <div class="meta-item">
          <span class="meta-label">Type:</span>
          <span class="meta-value">agent</span>
        </div>
        <div class="meta-item">
          <span class="meta-label">Duration:</span>
          <span class="meta-value">100.4s</span>
        </div>
        <div class="meta-item">
          <span class="meta-label">Execution #:</span>
          <span class="meta-value">2</span>
        </div>
        
        <div class="meta-item">
          <span class="meta-label">Prompt Size:</span>
          <span class="meta-value">5,930 chars</span>
        </div>
        
        
        <div class="meta-item">
          <span class="meta-label">Output Size:</span>
          <span class="meta-value">16,815 chars</span>
        </div>
        
      </div>

      
      <div class="prompt-section">
        <div class="section-label">ğŸ“¥ AGENT PROMPT <span class="char-count">(5,930 characters)</span></div>
        <button class="collapsible" data-target="prompt_database_architect_2">Click to expand prompt from database_architect</button>
        <div class="collapsible-content" id="prompt_database_architect_2">
          <pre class="code-content">You are a database architect who designs efficient, scalable, and secure database systems for enterprise applications. Your role is to create data models that support business requirements while ensuring optimal performance.

When designing database architecture:
- Create comprehensive data models and schemas
- Design for scalability and performance optimization
- Implement proper indexing and query optimization
- Plan data migration and ETL strategies
- Ensure data security and compliance requirements
- Design backup and disaster recovery procedures
- Plan for data analytics and reporting needs
- Implement data governance and quality standards

Database architecture components:
1. DATA MODELING: Conceptual, logical, and physical data models
2. SCHEMA DESIGN: Table structures, relationships, and constraints
3. INDEXING STRATEGY: Performance optimization through proper indexing
4. QUERY OPTIMIZATION: Efficient query design and execution plans
5. SCALABILITY DESIGN: Horizontal and vertical scaling strategies
6. SECURITY FRAMEWORK: Data encryption and access controls
7. BACKUP STRATEGY: Data protection and disaster recovery
8. ANALYTICS ARCHITECTURE: Data warehouse and BI integration

Data modeling approach:
- Entity-Relationship (ER) modeling for relational databases
- Document modeling for NoSQL databases
- Dimensional modeling for data warehouses
- Graph modeling for relationship-heavy data
- Time-series modeling for temporal data
- Event sourcing for audit trails
- CQRS pattern for read/write separation
- Microservice data architecture patterns

Database technology selection:
- PostgreSQL for complex relational data and ACID compliance
- MySQL for high-performance web applications
- MongoDB for flexible document-based schemas
- Redis for caching and session management
- Elasticsearch for full-text search and analytics
- InfluxDB for time-series data and metrics
- Neo4j for graph-based relationships
- Apache Cassandra for high-volume distributed data

Schema design principles:
- Normalized design for data integrity
- Denormalized design for performance optimization
- Proper foreign key relationships and constraints
- Data type optimization for storage efficiency
- Partitioning strategies for large tables
- Archival and data lifecycle management
- Version control for schema changes
- Migration scripts and rollback procedures

Performance optimization:
- Strategic index creation and maintenance
- Query execution plan analysis
- Database statistics and cost-based optimization
- Materialized views for complex queries
- Connection pooling and resource management
- Read replicas for scaling read operations
- Caching strategies at multiple levels
- Database tuning and configuration optimization

Scalability architecture:
- Horizontal sharding strategies
- Vertical partitioning techniques
- Read replica configuration
- Master-slave replication setup
- Multi-master replication for high availability
- Database clustering and load balancing
- Microservice database patterns
- Event-driven data synchronization

Data security implementation:
- Encryption at rest using database-native encryption
- Encryption in transit with SSL/TLS
- Column-level encryption for sensitive data
- Access control and user privilege management
- Row-level security for multi-tenant applications
- Data masking and anonymization
- Audit logging and compliance tracking
- Database firewall and intrusion detection

Backup and disaster recovery:
- Automated backup scheduling and retention
- Point-in-time recovery capabilities
- Cross-region backup replication
- Database snapshot and cloning procedures
- Disaster recovery testing and validation
- Recovery time objective (RTO) planning
- Recovery point objective (RPO) compliance
- Business continuity procedures

Data migration strategies:
- Legacy system data extraction
- Data transformation and cleansing
- Incremental migration approaches
- Zero-downtime migration techniques
- Data validation and reconciliation
- Rollback procedures and contingency planning
- Performance impact assessment
- Migration testing and validation

Analytics and reporting architecture:
- Data warehouse design and implementation
- ETL/ELT pipeline development
- Real-time analytics with streaming data
- OLAP cube design for multidimensional analysis
- Data lake architecture for big data
- Business intelligence integration
- Reporting database optimization
- Data mart creation for specific domains

Data governance framework:
- Data quality standards and validation
- Master data management (MDM)
- Data lineage and impact analysis
- Data classification and cataloging
- Privacy and compliance management
- Data retention and archival policies
- Change management procedures
- Documentation and metadata management

Monitoring and maintenance:
- Database performance monitoring
- Query performance analysis and optimization
- Storage growth tracking and planning
- Index maintenance and optimization
- Statistics update automation
- Deadlock detection and resolution
- Resource utilization monitoring
- Capacity planning and forecasting

Compliance and regulations:
- GDPR compliance for data privacy
- HIPAA requirements for healthcare data
- PCI DSS for payment card data
- SOX compliance for financial data
- Industry-specific regulatory requirements
- Data residency and sovereignty requirements
- Audit trail and reporting capabilities
- Right to be forgotten implementation

Provide comprehensive database architecture with implementation guides and best practices.

=== ROUTING DECISION REQUIRED ===
After your response, you MUST choose exactly ONE decision from:
- completed: Go to fullstack_developer
- completed: Go to product_catalog_manager
- completed: Go to backup_disaster_specialist

**CRITICAL**: Your VERY LAST LINE must be exactly:
DECISION: [ONE_OF_THE_ABOVE_CHOICES]
Example: DECISION: completed
Do NOT add explanations after the decision keyword.
</pre>
        </div>
      </div>
      

      
      <div class="output-section">
        <div class="section-label">ğŸ“¤ AGENT OUTPUT <span class="char-count">(16,815 characters)</span></div>
        <button class="collapsible" data-target="output_database_architect_2">Click to expand output from database_architect</button>
        <div class="collapsible-content" id="output_database_architect_2">
          <pre class="code-content">## Database Architecture for MineBox Platform

Based on the thesis document, I&#039;ll design a comprehensive database architecture to support MineBox&#039;s multi-coin hobbyist mining infrastructure platform.

---

## Data Model Overview

### Core Domain Entities

The MineBox platform requires databases for:
1. **User/Account Management** - Hobbyist miners, subscriptions, authentication
2. **Node Infrastructure** - Multi-coin daemon configurations, snapshots, sync status
3. **Mining Operations** - Stratum connections, share submissions, block discoveries
4. **Snapshot Service** - Snapshot metadata, verification hashes, download tracking
5. **Analytics/Telemetry** - Performance metrics, uptime, profitability calculations

---

## Conceptual Data Model

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     USERS       â”‚â”€â”€â”€â”€&lt;â”‚  SUBSCRIPTIONS  â”‚&gt;â”€â”€â”€â”€â”‚  SNAPSHOT_PLANS â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                       â”‚
        â”‚                       â”‚
        â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   DEVICES       â”‚â”€â”€â”€â”€&lt;â”‚  DEVICE_COINS   â”‚
â”‚  (Raspberry Pi) â”‚     â”‚  (active nodes) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                       â”‚
        â”‚                       â–¼
        â”‚               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚               â”‚     COINS       â”‚
        â”‚               â”‚ (SHA256 alts)   â”‚
        â”‚               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                       â”‚
        â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    MINERS       â”‚     â”‚   SNAPSHOTS     â”‚
â”‚   (Bitaxe)      â”‚     â”‚  (blockchain)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                       â”‚
        â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    SHARES       â”‚     â”‚ SNAPSHOT_CHUNKS â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    BLOCKS       â”‚
â”‚  (discovered)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Physical Schema Design (PostgreSQL)

### Users &amp; Authentication

```sql
-- Core user accounts
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    email VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    display_name VARCHAR(100),
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW(),
    email_verified BOOLEAN DEFAULT FALSE,
    last_login_at TIMESTAMPTZ,
    preferences JSONB DEFAULT &#039;{}&#039;::jsonb
);

CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_users_created_at ON users(created_at);

-- Subscription management
CREATE TABLE subscription_plans (
    id SERIAL PRIMARY KEY,
    name VARCHAR(50) NOT NULL,           -- &#039;free&#039;, &#039;hobbyist&#039;, &#039;enthusiast&#039;
    monthly_price_cents INTEGER NOT NULL,
    snapshot_downloads_per_month INTEGER, -- NULL = unlimited
    coins_supported INTEGER,              -- max coins per device
    priority_support BOOLEAN DEFAULT FALSE,
    features JSONB DEFAULT &#039;{}&#039;::jsonb
);

CREATE TABLE subscriptions (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id) ON DELETE CASCADE,
    plan_id INTEGER REFERENCES subscription_plans(id),
    status VARCHAR(20) DEFAULT &#039;active&#039;,  -- active, cancelled, expired
    started_at TIMESTAMPTZ DEFAULT NOW(),
    expires_at TIMESTAMPTZ,
    stripe_subscription_id VARCHAR(255),
    UNIQUE(user_id)
);

CREATE INDEX idx_subscriptions_user ON subscriptions(user_id);
CREATE INDEX idx_subscriptions_status ON subscriptions(status);
```

### Coin Configuration

```sql
-- Supported SHA256 coins
CREATE TABLE coins (
    id SERIAL PRIMARY KEY,
    symbol VARCHAR(10) UNIQUE NOT NULL,    -- &#039;BTC&#039;, &#039;BSV&#039;, &#039;BTCZ&#039;
    name VARCHAR(100) NOT NULL,
    algorithm VARCHAR(50) DEFAULT &#039;sha256d&#039;,
    is_active BOOLEAN DEFAULT TRUE,
    
    -- Network parameters
    default_rpc_port INTEGER,
    default_p2p_port INTEGER,
    default_stratum_port INTEGER,
    
    -- Profitability metrics (updated regularly)
    current_difficulty NUMERIC(30, 8),
    network_hashrate NUMERIC(30, 0),
    block_reward NUMERIC(20, 8),
    block_time_seconds INTEGER,
    
    -- Storage requirements
    blockchain_size_gb NUMERIC(10, 2),
    growth_rate_gb_per_month NUMERIC(6, 2),
    
    -- Daemon configuration
    daemon_config_template JSONB,
    
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Expected block discovery times (pre-calculated)
CREATE TABLE coin_profitability (
    id SERIAL PRIMARY KEY,
    coin_id INTEGER REFERENCES coins(id),
    hashrate_ths NUMERIC(10, 4),           -- Bitaxe hashrate in TH/s
    expected_blocks_per_year NUMERIC(10, 4),
    expected_revenue_usd_per_year NUMERIC(12, 2),
    calculated_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_coin_profitability_coin ON coin_profitability(coin_id);
```

### Device &amp; Node Management

```sql
-- User devices (Raspberry Pi deployments)
CREATE TABLE devices (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id) ON DELETE CASCADE,
    name VARCHAR(100),
    hardware_type VARCHAR(50) DEFAULT &#039;raspberry_pi_5&#039;,
    
    -- Device identification
    device_fingerprint VARCHAR(255) UNIQUE,
    last_seen_at TIMESTAMPTZ,
    ip_address INET,
    
    -- Status
    status VARCHAR(20) DEFAULT &#039;provisioning&#039;, -- provisioning, online, offline
    version VARCHAR(20),                        -- MineBox software version
    
    -- Hardware metrics
    storage_total_gb INTEGER,
    storage_used_gb INTEGER,
    memory_total_mb INTEGER,
    
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_devices_user ON devices(user_id);
CREATE INDEX idx_devices_status ON devices(status);

-- Coins configured on each device
CREATE TABLE device_coins (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    device_id UUID REFERENCES devices(id) ON DELETE CASCADE,
    coin_id INTEGER REFERENCES coins(id),
    
    -- Node status
    sync_status VARCHAR(20) DEFAULT &#039;pending&#039;, -- pending, syncing, synced, error
    sync_progress_percent NUMERIC(5, 2),
    block_height INTEGER,
    
    -- Stratum configuration
    stratum_enabled BOOLEAN DEFAULT TRUE,
    stratum_port INTEGER,
    
    -- RPC configuration
    rpc_port INTEGER,
    rpc_user VARCHAR(100),
    rpc_password_encrypted BYTEA,
    
    -- Snapshot used
    snapshot_id UUID,
    
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW(),
    
    UNIQUE(device_id, coin_id)
);

CREATE INDEX idx_device_coins_device ON device_coins(device_id);
CREATE INDEX idx_device_coins_coin ON device_coins(coin_id);
CREATE INDEX idx_device_coins_status ON device_coins(sync_status);
```

### Miner Management

```sql
-- Connected mining hardware
CREATE TABLE miners (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    device_id UUID REFERENCES devices(id) ON DELETE CASCADE,
    
    -- Miner identification
    name VARCHAR(100),
    hardware_type VARCHAR(50),              -- &#039;bitaxe_ultra&#039;, &#039;bitaxe_hex&#039;, etc.
    worker_name VARCHAR(100),
    
    -- Connection info
    last_connected_at TIMESTAMPTZ,
    connection_status VARCHAR(20) DEFAULT &#039;disconnected&#039;,
    connected_coin_id INTEGER REFERENCES coins(id),
    
    -- Performance metrics
    hashrate_ths NUMERIC(10, 4),
    shares_submitted_total BIGINT DEFAULT 0,
    shares_valid_total BIGINT DEFAULT 0,
    
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_miners_device ON miners(device_id);
CREATE INDEX idx_miners_status ON miners(connection_status);

-- Share submissions (partitioned by time)
CREATE TABLE shares (
    id BIGSERIAL,
    miner_id UUID NOT NULL,
    coin_id INTEGER NOT NULL,
    device_coin_id UUID NOT NULL,
    
    -- Share data
    share_diff NUMERIC(30, 8) NOT NULL,
    network_diff NUMERIC(30, 8),
    nonce BYTEA,
    extra_nonce BYTEA,
    
    -- Validation
    is_valid BOOLEAN NOT NULL,
    is_block BOOLEAN DEFAULT FALSE,
    error_code VARCHAR(50),
    
    submitted_at TIMESTAMPTZ DEFAULT NOW(),
    
    PRIMARY KEY (id, submitted_at)
) PARTITION BY RANGE (submitted_at);

-- Create monthly partitions
CREATE TABLE shares_2024_01 PARTITION OF shares
    FOR VALUES FROM (&#039;2024-01-01&#039;) TO (&#039;2024-02-01&#039;);
-- ... additional partitions

CREATE INDEX idx_shares_miner ON shares(miner_id, submitted_at);
CREATE INDEX idx_shares_coin ON shares(coin_id, submitted_at);
CREATE INDEX idx_shares_is_block ON shares(is_block) WHERE is_block = TRUE;
```

### Block Discovery

```sql
-- Discovered blocks (the exciting part!)
CREATE TABLE blocks (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    coin_id INTEGER REFERENCES coins(id),
    device_id UUID REFERENCES devices(id),
    miner_id UUID REFERENCES miners(id),
    share_id BIGINT,
    
    -- Block data
    block_hash VARCHAR(64) NOT NULL,
    block_height INTEGER NOT NULL,
    block_reward NUMERIC(20, 8),
    block_reward_usd NUMERIC(12, 2),     -- At time of discovery
    
    -- Verification
    confirmations INTEGER DEFAULT 0,
    is_orphaned BOOLEAN DEFAULT FALSE,
    is_mature BOOLEAN DEFAULT FALSE,
    
    -- Timing
    discovered_at TIMESTAMPTZ DEFAULT NOW(),
    confirmed_at TIMESTAMPTZ,
    
    UNIQUE(coin_id, block_hash)
);

CREATE INDEX idx_blocks_coin ON blocks(coin_id);
CREATE INDEX idx_blocks_device ON blocks(device_id);
CREATE INDEX idx_blocks_discovered ON blocks(discovered_at);
CREATE INDEX idx_blocks_orphaned ON blocks(is_orphaned);
```

### Snapshot Infrastructure

```sql
-- Blockchain snapshots (core monetization)
CREATE TABLE snapshots (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    coin_id INTEGER REFERENCES coins(id),
    
    -- Snapshot metadata
    version INTEGER NOT NULL,
    block_height INTEGER NOT NULL,
    block_hash VARCHAR(64) NOT NULL,
    
    -- Size and storage
    size_bytes BIGINT NOT NULL,
    compressed_size_bytes BIGINT NOT NULL,
    chunk_count INTEGER NOT NULL,
    
    -- Cryptographic verification
    merkle_root VARCHAR(64) NOT NULL,      -- For chunk verification
    utxo_set_hash VARCHAR(64),             -- UTXO commitment
    checksum_sha256 VARCHAR(64) NOT NULL,
    
    -- Status
    status VARCHAR(20) DEFAULT &#039;generating&#039;, -- generating, available, deprecated
    is_current BOOLEAN DEFAULT FALSE,
    
    -- S3/Storage location
    storage_bucket VARCHAR(255),
    storage_prefix VARCHAR(255),
    
    created_at TIMESTAMPTZ DEFAULT NOW(),
    deprecated_at TIMESTAMPTZ,
    
    UNIQUE(coin_id, block_height)
);

CREATE INDEX idx_snapshots_coin ON snapshots(coin_id);
CREATE INDEX idx_snapshots_current ON snapshots(coin_id, is_current) WHERE is_current = TRUE;

-- Snapshot chunks for resumable downloads
CREATE TABLE snapshot_chunks (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    snapshot_id UUID REFERENCES snapshots(id) ON DELETE CASCADE,
    
    chunk_index INTEGER NOT NULL,
    size_bytes INTEGER NOT NULL,
    checksum_sha256 VARCHAR(64) NOT NULL,
    storage_key VARCHAR(255) NOT NULL,
    
    UNIQUE(snapshot_id, chunk_index)
);

CREATE INDEX idx_snapshot_chunks_snapshot ON snapshot_chunks(snapshot_id);

-- Download tracking (for billing and analytics)
CREATE TABLE snapshot_downloads (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    snapshot_id UUID REFERENCES snapshots(id),
    user_id UUID REFERENCES users(id),
    device_id UUID REFERENCES devices(id),
    
    -- Download progress
    started_at TIMESTAMPTZ DEFAULT NOW(),
    completed_at TIMESTAMPTZ,
    chunks_downloaded INTEGER DEFAULT 0,
    bytes_downloaded BIGINT DEFAULT 0,
    
    -- Verification
    verification_passed BOOLEAN,
    verified_at TIMESTAMPTZ
);

CREATE INDEX idx_snapshot_downloads_user ON snapshot_downloads(user_id);
CREATE INDEX idx_snapshot_downloads_snapshot ON snapshot_downloads(snapshot_id);
CREATE INDEX idx_snapshot_downloads_month ON snapshot_downloads(user_id, started_at);
```

### Telemetry &amp; Analytics

```sql
-- Device performance metrics (time-series, consider InfluxDB for production)
CREATE TABLE device_metrics (
    device_id UUID NOT NULL,
    recorded_at TIMESTAMPTZ DEFAULT NOW(),
    
    -- System metrics
    cpu_usage_percent NUMERIC(5, 2),
    memory_usage_percent NUMERIC(5, 2),
    disk_usage_percent NUMERIC(5, 2),
    temperature_celsius NUMERIC(5, 2),
    
    -- Network metrics
    network_in_bytes BIGINT,
    network_out_bytes BIGINT,
    
    -- Per-coin daemon status
    daemon_status JSONB,    -- {coin_symbol: {synced: true, height: 123456}}
    
    PRIMARY KEY (device_id, recorded_at)
);

-- Partition by time for efficient retention
SELECT create_hypertable(&#039;device_metrics&#039;, &#039;recorded_at&#039;, 
    chunk_time_interval =&gt; INTERVAL &#039;1 day&#039;,
    if_not_exists =&gt; TRUE);

-- Aggregated mining statistics
CREATE TABLE mining_stats_daily (
    id SERIAL PRIMARY KEY,
    device_id UUID NOT NULL,
    coin_id INTEGER NOT NULL,
    stat_date DATE NOT NULL,
    
    shares_submitted BIGINT DEFAULT 0,
    shares_valid BIGINT DEFAULT 0,
    shares_invalid BIGINT DEFAULT 0,
    blocks_found INTEGER DEFAULT 0,
    
    avg_hashrate_ths NUMERIC(10, 4),
    uptime_percent NUMERIC(5, 2),
    
    UNIQUE(device_id, coin_id, stat_date)
);

CREATE INDEX idx_mining_stats_device ON mining_stats_daily(device_id, stat_date);
```

---

## Indexing Strategy

### Primary Query Patterns

1. **User dashboard**: Device status, mining stats, block discoveries
2. **Snapshot downloads**: Current snapshots per coin, download tracking
3. **Share processing**: High-volume insert, periodic aggregation
4. **Block verification**: Confirmation updates, orphan detection

### Key Indexes

```sql
-- Composite indexes for common queries
CREATE INDEX idx_device_coins_active 
    ON device_coins(device_id, coin_id) 
    WHERE sync_status = &#039;synced&#039;;

CREATE INDEX idx_shares_recent 
    ON shares(miner_id, submitted_at DESC) 
    WHERE submitted_at &gt; NOW() - INTERVAL &#039;24 hours&#039;;

CREATE INDEX idx_blocks_user_recent 
    ON blocks(device_id, discovered_at DESC);

-- Partial index for active subscriptions
CREATE INDEX idx_subscriptions_active 
    ON subscriptions(user_id) 
    WHERE status = &#039;active&#039;;
```

---

## Scalability Considerations

### Partitioning Strategy

1. **Shares table**: Partition by month (high-volume writes)
2. **Device metrics**: TimescaleDB hypertable with daily chunks
3. **Snapshot downloads**: Partition by quarter for billing queries

### Read Replicas

```
Primary (writes) â”€â”€â”€â”€â”€â”€â–º Read Replica 1 (dashboard queries)
                  â””â”€â”€â”€â”€â–º Read Replica 2 (analytics/reporting)
```

### Connection Pooling

- PgBouncer for connection management
- Target: 50 connections per Pi device, pooled to 500 max DB connections

---

## Security Implementation

```sql
-- Row-level security for multi-tenant isolation
ALTER TABLE devices ENABLE ROW LEVEL SECURITY;

CREATE POLICY devices_user_isolation ON devices
    USING (user_id = current_setting(&#039;app.current_user_id&#039;)::uuid);

-- Encrypt sensitive fields
CREATE EXTENSION IF NOT EXISTS pgcrypto;

-- RPC passwords stored encrypted
-- Decryption handled in application layer with user-specific keys
```

---

## Backup Strategy

| Component | RPO | RTO | Method |
|-----------|-----|-----|--------|
| User data | 1 hour | 4 hours | WAL streaming + daily snapshots |
| Share data | 24 hours | 8 hours | Daily backups (reconstructable) |
| Snapshots metadata | 1 hour | 2 hours | Same as user data |
| Metrics | 7 days | 24 hours | Weekly exports to cold storage |

---

## Revenue-Critical Queries

```sql
-- Monthly snapshot downloads per user (billing)
SELECT 
    u.id,
    u.email,
    sp.name as plan,
    sp.snapshot_downloads_per_month as limit,
    COUNT(sd.id) as downloads_this_month
FROM users u
JOIN subscriptions s ON s.user_id = u.id
JOIN subscription_plans sp ON sp.id = s.plan_id
LEFT JOIN snapshot_downloads sd ON sd.user_id = u.id 
    AND sd.started_at &gt;= DATE_TRUNC(&#039;month&#039;, CURRENT_DATE)
GROUP BY u.id, u.email, sp.name, sp.snapshot_downloads_per_month;

-- Block discovery leaderboard (community engagement)
SELECT 
    u.display_name,
    c.symbol,
    COUNT(b.id) as blocks_found,
    SUM(b.block_reward) as total_rewards
FROM blocks b
JOIN devices d ON d.id = b.device_id
JOIN users u ON u.id = d.user_id
JOIN coins c ON c.id = b.coin_id
WHERE b.is_orphaned = FALSE
GROUP BY u.display_name, c.symbol
ORDER BY blocks_found DESC;
```

---

This database architecture supports MineBox&#039;s core value proposition: making multi-coin solo mining accessible to hobbyists through snapshot-accelerated synchronization, while enabling the subscription-based business model through granular download tracking and usage metering.

DECISION: completed: Go to fullstack_developer</pre>
        </div>
      </div>
      

      

      
      <div class="routing-info">
        <div class="routing-decision">ğŸ”€ Routing Decision: COMPLETED</div>
        <div style="font-size: 0.9em; color: #555; margin-top: 5px;">Decision &quot;COMPLETED&quot; matched connection condition</div>
        <div style="margin-top: 10px; font-weight: bold;">â†’ Next Stage: <strong>fullstack_developer</strong></div>
      </div>
      
    </div>

    <div class="stage running">
      <div class="stage-header">
        <div>
          <div class="stage-title">Full-Stack Development</div>
          <div style="color: #6c757d; font-size: 0.9em; margin-top: 5px;">Build complete full-stack application with modern technologies</div>
        </div>
        <span class="stage-badge badge-running">running</span>
      </div>

      <div class="stage-meta">
        <div class="meta-item">
          <span class="meta-label">Agent:</span>
          <span class="meta-value">fullstack_developer</span>
        </div>
        <div class="meta-item">
          <span class="meta-label">Type:</span>
          <span class="meta-value">agent</span>
        </div>
        <div class="meta-item">
          <span class="meta-label">Duration:</span>
          <span class="meta-value">In progress...</span>
        </div>
        <div class="meta-item">
          <span class="meta-label">Execution #:</span>
          <span class="meta-value">3</span>
        </div>
        
        
      </div>

      

      

      

      
    </div>
    </div>

    
  </div>

  <script>
    // Interactive collapsible sections
    document.addEventListener('DOMContentLoaded', function() {
      const collapsibles = document.querySelectorAll('.collapsible');

      collapsibles.forEach(button => {
        button.addEventListener('click', function() {
          this.classList.toggle('active');
          const targetId = this.getAttribute('data-target');
          const content = document.getElementById(targetId);

          if (content) {
            content.classList.toggle('active');
          }
        });
      });

      // Add "Expand All" / "Collapse All" buttons
      const header = document.querySelector('.header');
      if (header && collapsibles.length > 0) {
        const controlsDiv = document.createElement('div');
        controlsDiv.style.marginTop = '20px';

        const collapseAllBtn = document.createElement('button');
        collapseAllBtn.textContent = 'Collapse All Sections';
        collapseAllBtn.style.cssText = 'padding: 10px 20px; background: #6c757d; color: white; border: none; border-radius: 6px; cursor: pointer; margin-right: 10px; font-weight: bold;';
        collapseAllBtn.addEventListener('click', function() {
          collapsibles.forEach(btn => {
            btn.classList.add('active');
            const targetId = btn.getAttribute('data-target');
            const content = document.getElementById(targetId);
            if (content) content.classList.add('active');
          });
        });

        const expandAllBtn = document.createElement('button');
        expandAllBtn.textContent = 'Expand All Sections';
        expandAllBtn.style.cssText = 'padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold;';
        expandAllBtn.addEventListener('click', function() {
          collapsibles.forEach(btn => {
            btn.classList.remove('active');
            const targetId = btn.getAttribute('data-target');
            const content = document.getElementById(targetId);
            if (content) content.classList.remove('active');
          });
        });

        controlsDiv.appendChild(collapseAllBtn);
        controlsDiv.appendChild(expandAllBtn);
        header.appendChild(controlsDiv);
      }
    });
  </script>
</body>
</html>