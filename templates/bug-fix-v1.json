{
  "id": "bug-fix-v1",
  "name": "Bug Fix Pipeline V1",
  "description": "Comprehensive bug fix workflow with reproduction, root cause analysis, fix implementation, and unbiased validation",
  "version": "1.0.0",
  "category": "development",
  "stages": [
    {
      "id": "bug_analysis",
      "name": "Bug Analysis",
      "type": "analyzer",
      "agent": "bug_analyzer",
      "description": "Analyze bug report to understand symptoms, scope, and reproduction steps",
      "decisions": [
        {"choice": "analysis_complete", "description": "Bug analysis complete with reproduction steps identified"}
      ]
    },
    {
      "id": "create_reproduction",
      "name": "Create Reproduction Script",
      "type": "creator",
      "agent": "reproduction_creator",
      "description": "Create automated script to reproduce the bug using Windows commands",
      "inputs": ["bug_analysis"],
      "decisions": [
        {"choice": "script_ready", "description": "Reproduction script created and ready to execute"},
        {"choice": "need_command_implementation", "description": "Bug requires automation command that doesn't exist yet"}
      ]
    },
    {
      "id": "implement_automation_command",
      "name": "Implement Automation Command",
      "type": "developer",
      "agent": "command_implementer",
      "description": "Add missing automation command to GameTestingInterface.js",
      "inputs": ["create_reproduction"],
      "decisions": [
        {"choice": "command_implemented", "description": "New automation command added to GameTestingInterface"},
        {"choice": "cannot_implement", "description": "Command cannot be implemented automatically"}
      ]
    },
    {
      "id": "run_reproduction",
      "name": "Run Reproduction Test",
      "type": "executor",
      "agent": "game_runner",
      "description": "Execute reproduction script and capture evidence objectively",
      "inputs": ["create_reproduction"],
      "decisions": [
        {"choice": "execution_complete", "description": "Reproduction test executed, evidence collected"},
        {"choice": "FRAMEWORK_ERROR", "description": "Test infrastructure failure detected"}
      ]
    },
    {
      "id": "verify_bug",
      "name": "Verify Bug Exists",
      "type": "validator",
      "agent": "bug_verifier",
      "description": "Confirm bug actually exists based on reproduction evidence",
      "inputs": ["bug_analysis", "run_reproduction"],
      "decisions": [
        {"choice": "BUG_CONFIRMED", "description": "Bug confirmed, proceed to root cause analysis"},
        {"choice": "NOT_REPRODUCED", "description": "Bug not reproduced, cannot confirm"},
        {"choice": "INCONCLUSIVE", "description": "Need more testing or different approach"},
        {"choice": "FRAMEWORK_ERROR", "description": "Test infrastructure broken, cannot verify with current automation"}
      ]
    },
    {
      "id": "root_cause",
      "name": "Root Cause Analysis",
      "type": "analyzer",
      "agent": "root_cause_analyzer",
      "description": "Investigate code to find the root cause of the bug",
      "inputs": ["bug_analysis", "verify_bug"],
      "decisions": [
        {"choice": "root_cause_found", "description": "Root cause identified with proposed fix"}
      ]
    },
    {
      "id": "implement_fix",
      "name": "Implement Fix",
      "type": "executor",
      "agent": "code_fixer",
      "description": "Implement the bug fix based on root cause analysis",
      "inputs": ["root_cause"],
      "decisions": [
        {"choice": "fix_implemented", "description": "Fix implemented in code"}
      ]
    },
    {
      "id": "run_validation",
      "name": "Run Validation Test",
      "type": "executor",
      "agent": "game_runner",
      "description": "Run game with fix to capture actual behavior",
      "inputs": ["implement_fix", "create_reproduction"],
      "decisions": [
        {"choice": "execution_complete", "description": "Validation test executed, evidence collected"},
        {"choice": "FRAMEWORK_ERROR", "description": "Test infrastructure failure detected"}
      ]
    },
    {
      "id": "validate_fix",
      "name": "Validate Fix",
      "type": "validator",
      "agent": "fix_validator",
      "description": "Verify bug is fixed and no regressions introduced",
      "inputs": ["bug_analysis", "implement_fix", "run_validation"],
      "decisions": [
        {"choice": "FIX_VERIFIED", "description": "Bug fixed successfully, no regressions"},
        {"choice": "FIX_INCOMPLETE", "description": "Bug still occurs or partially fixed"},
        {"choice": "NEW_ISSUES", "description": "Fix introduced new problems"}
      ]
    },
    {
      "id": "fix_automation_framework",
      "name": "Fix Automation Framework",
      "type": "developer",
      "agent": "automation_framework_fixer",
      "description": "Developer-side agent that fixes test infrastructure, WebSocket setup, browser automation issues, or framework problems",
      "inputs": ["run_reproduction", "run_validation"],
      "decisions": [
        {"choice": "framework_fixed_retry_reproduction", "description": "Test infrastructure fixed, retry reproduction test"},
        {"choice": "framework_fixed_retry_validation", "description": "Test infrastructure fixed, retry validation test"},
        {"choice": "cannot_fix", "description": "Framework issue requires manual intervention"}
      ]
    }
  ],
  "flow": {
    "type": "conditional",
    "description": "Bug fix workflow with verification loops",
    "connections": [
      {
        "from": "bug_analysis",
        "to": "create_reproduction",
        "condition": "analysis_complete",
        "description": "Bug analyzed, create reproduction script"
      },
      {
        "from": "create_reproduction",
        "to": "run_reproduction",
        "condition": "script_ready",
        "description": "Script ready, execute reproduction test"
      },
      {
        "from": "create_reproduction",
        "to": "implement_automation_command",
        "condition": "need_command_implementation",
        "description": "Missing automation command, implement it first"
      },
      {
        "from": "implement_automation_command",
        "to": "create_reproduction",
        "condition": "command_implemented",
        "description": "Command implemented, retry creating reproduction script"
      },
      {
        "from": "implement_automation_command",
        "to": null,
        "condition": "cannot_implement",
        "description": "Cannot implement command automatically - PIPELINE ENDS"
      },
      {
        "from": "run_reproduction",
        "to": "verify_bug",
        "condition": "execution_complete",
        "description": "Evidence collected, verify bug exists"
      },
      {
        "from": "run_reproduction",
        "to": "fix_automation_framework",
        "condition": "FRAMEWORK_ERROR",
        "description": "Test infrastructure failed, fix automation framework"
      },
      {
        "from": "verify_bug",
        "to": "root_cause",
        "condition": "BUG_CONFIRMED",
        "description": "Bug confirmed, analyze root cause"
      },
      {
        "from": "verify_bug",
        "to": null,
        "condition": "NOT_REPRODUCED",
        "description": "Bug not reproduced - PIPELINE ENDS"
      },
      {
        "from": "verify_bug",
        "to": "create_reproduction",
        "condition": "INCONCLUSIVE",
        "description": "Inconclusive, try different reproduction approach"
      },
      {
        "from": "verify_bug",
        "to": "fix_automation_framework",
        "condition": "FRAMEWORK_ERROR",
        "description": "Validator detected broken automation, fix framework before proceeding"
      },
      {
        "from": "root_cause",
        "to": "implement_fix",
        "condition": "root_cause_found",
        "description": "Root cause found, implement fix"
      },
      {
        "from": "implement_fix",
        "to": "run_validation",
        "condition": "fix_implemented",
        "description": "Fix implemented, run validation test"
      },
      {
        "from": "run_validation",
        "to": "validate_fix",
        "condition": "execution_complete",
        "description": "Validation evidence collected, verify fix"
      },
      {
        "from": "run_validation",
        "to": "fix_automation_framework",
        "condition": "FRAMEWORK_ERROR",
        "description": "Test infrastructure failed, fix automation framework"
      },
      {
        "from": "validate_fix",
        "to": null,
        "condition": "FIX_VERIFIED",
        "description": "Fix verified successful - PIPELINE ENDS"
      },
      {
        "from": "validate_fix",
        "to": "root_cause",
        "condition": "FIX_INCOMPLETE",
        "description": "Fix incomplete, re-analyze root cause"
      },
      {
        "from": "validate_fix",
        "to": "implement_fix",
        "condition": "NEW_ISSUES",
        "description": "New issues found, revise fix"
      },
      {
        "from": "fix_automation_framework",
        "to": "run_reproduction",
        "condition": "framework_fixed_retry_reproduction",
        "description": "Framework fixed, retry reproduction"
      },
      {
        "from": "fix_automation_framework",
        "to": "run_validation",
        "condition": "framework_fixed_retry_validation",
        "description": "Framework fixed, retry validation"
      },
      {
        "from": "fix_automation_framework",
        "to": null,
        "condition": "cannot_fix",
        "description": "Framework issue requires manual intervention - PIPELINE ENDS"
      }
    ]
  },
  "metadata": {
    "tags": ["bug-fix", "testing", "validation", "debugging"],
    "author": "Claude Plus Development System",
    "usesWindowsCommands": true,
    "requiresBrowser": true
  }
}
