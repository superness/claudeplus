{
  "id": "research-batch-processor",
  "name": "Research Batch Processor",
  "description": "Processes all research spike stubs, expanding each into complete research documents through prior art analysis and synthesis",
  "version": "1.0.0",
  "stages": [
    {
      "id": "select_research",
      "name": "Select Next Research Topic",
      "description": "Find the next research stub to expand",
      "agent": "research_topic_selector",
      "config": {
        "inputs": [],
        "outputs": ["selected_file", "selected_topic", "research_question", "prior_art_areas"]
      }
    },
    {
      "id": "generate_research",
      "name": "Generate Research Document",
      "description": "Run the research generator sub-pipeline",
      "type": "sub_pipeline",
      "config": {
        "pipeline": "research-generator-v1",
        "inputs": ["select_research"],
        "outputs": ["research_content"],
        "contextMapping": {
          "research_file": "{{select_research.selected_file}}",
          "research_topic": "{{select_research.selected_topic}}",
          "research_question": "{{select_research.research_question}}",
          "prior_art_areas": "{{select_research.prior_art_areas}}"
        }
      }
    },
    {
      "id": "completion_check",
      "name": "Check Completion",
      "description": "Check if all research stubs have been expanded",
      "agent": "research_topic_selector",
      "config": {
        "inputs": ["generate_research"],
        "outputs": ["completion_status"]
      }
    }
  ],
  "connections": [
    {"from": "select_research", "to": "generate_research"},
    {"from": "generate_research", "to": "completion_check"},
    {"from": "completion_check", "to": "select_research", "condition": "decision === 'process_research'"}
  ],
  "entryPoint": "select_research",
  "terminationConditions": [
    {
      "stage": "select_research",
      "condition": "decision === 'all_complete'",
      "message": "All research spikes have been expanded"
    },
    {
      "stage": "completion_check",
      "condition": "decision === 'all_complete'",
      "message": "All research spikes have been expanded"
    }
  ]
}
