{
  "id": "feature-development-v1",
  "name": "Feature Development Pipeline V1",
  "description": "Test-first feature development with unbiased validation. Defines expectations before implementation, then compares actual behavior against expectations.",
  "version": "1.0.0",
  "category": "development",
  "stages": [
    {
      "id": "define_feature",
      "name": "Feature Definition",
      "type": "planner",
      "agent": "feature_definer",
      "description": "Define feature specifications and acceptance criteria",
      "decisions": [
        {"choice": "feature_defined", "description": "Feature clearly defined with acceptance criteria"}
      ]
    },
    {
      "id": "plan_tests",
      "name": "Test Planning",
      "type": "planner",
      "agent": "test_planner",
      "description": "Create test plan with expected behaviors BEFORE implementation",
      "inputs": ["define_feature"],
      "decisions": [
        {"choice": "test_plan_ready", "description": "Test plan created with specific expectations"}
      ]
    },
    {
      "id": "plan_implementation",
      "name": "Implementation Planning",
      "type": "planner",
      "agent": "implementation_planner",
      "description": "Design technical approach and implementation strategy",
      "inputs": ["define_feature", "plan_tests"],
      "decisions": [
        {"choice": "implementation_plan_ready", "description": "Technical plan ready for implementation"}
      ]
    },
    {
      "id": "implement_feature",
      "name": "Feature Implementation",
      "type": "executor",
      "agent": "code_implementer",
      "description": "Write code to implement the feature",
      "inputs": ["plan_implementation"],
      "decisions": [
        {"choice": "implementation_complete", "description": "Feature code implemented"}
      ]
    },
    {
      "id": "run_tests",
      "name": "Run Feature Tests",
      "type": "executor",
      "agent": "feature_validator",
      "description": "Execute pre-written test script to validate feature implementation",
      "inputs": ["implement_feature", "plan_tests"],
      "decisions": [
        {"choice": "tests_executed", "description": "Tests ran successfully, results captured"},
        {"choice": "no_tests_to_run", "description": "No test script found to execute"},
        {"choice": "test_execution_failed", "description": "Test script exists but failed to run"},
        {"choice": "environment_error", "description": "HTTP server, Chrome, or infrastructure issue"}
      ]
    },
    {
      "id": "observe_behavior",
      "name": "Behavior Observation",
      "type": "observer",
      "agent": "behavior_observer",
      "description": "Report what actually happened without interpretation",
      "inputs": ["run_tests"],
      "decisions": [
        {"choice": "observation_complete", "description": "Objective observations recorded"}
      ]
    },
    {
      "id": "validate_expectations",
      "name": "Expectation Validation",
      "type": "validator",
      "agent": "expectation_validator",
      "description": "Compare expected behavior vs actual behavior objectively",
      "inputs": ["plan_tests", "observe_behavior"],
      "decisions": [
        {"choice": "FEATURE_COMPLETE", "description": "All acceptance criteria met"},
        {"choice": "NEEDS_REFINEMENT", "description": "Most criteria met, minor gaps"},
        {"choice": "INCOMPLETE", "description": "Significant criteria not met"},
        {"choice": "NEEDS_MORE_TESTING", "description": "Cannot verify due to test conditions"}
      ]
    },
    {
      "id": "finalize_tests",
      "name": "Finalize Feature Tests",
      "type": "validator",
      "agent": "qa_tester",
      "description": "Ensure all feature tests are properly named, documented, and ready for the test library",
      "inputs": ["validate_expectations", "plan_tests", "run_tests"],
      "decisions": [
        {"choice": "tests_finalized", "description": "Tests are properly documented and ready for collection"}
      ]
    },
    {
      "id": "collect_tests_to_library",
      "name": "Collect Tests to Library",
      "type": "executor",
      "agent": "test_librarian",
      "description": "Scan for test files, validate them, copy to test library, create metadata, and commit to git",
      "inputs": ["finalize_tests", "plan_tests", "run_tests"],
      "decisions": [
        {"choice": "tests_collected_and_committed", "description": "Tests collected, validated, and committed to git"},
        {"choice": "no_tests_found", "description": "No test files found in working directory"},
        {"choice": "all_tests_invalid", "description": "Tests found but all failed validation"}
      ]
    }
  ],
  "flow": {
    "type": "conditional",
    "description": "Test-first feature development with validation loops",
    "connections": [
      {
        "from": "define_feature",
        "to": "plan_tests",
        "condition": "feature_defined",
        "description": "Feature defined, create test plan"
      },
      {
        "from": "plan_tests",
        "to": "plan_implementation",
        "condition": "test_plan_ready",
        "description": "Tests planned, design implementation"
      },
      {
        "from": "plan_implementation",
        "to": "implement_feature",
        "condition": "implementation_plan_ready",
        "description": "Plan ready, implement feature"
      },
      {
        "from": "implement_feature",
        "to": "run_tests",
        "condition": "implementation_complete",
        "description": "Feature implemented, run automated tests"
      },
      {
        "from": "run_tests",
        "to": "observe_behavior",
        "condition": "tests_executed",
        "description": "Tests executed, observe and record results"
      },
      {
        "from": "run_tests",
        "to": "plan_tests",
        "condition": "no_tests_to_run",
        "description": "No test script found, return to test planning to write tests"
      },
      {
        "from": "run_tests",
        "to": null,
        "condition": "environment_error",
        "description": "Environment error - PIPELINE ENDS"
      },
      {
        "from": "observe_behavior",
        "to": "validate_expectations",
        "condition": "observation_complete",
        "description": "Behavior observed, validate against expectations"
      },
      {
        "from": "validate_expectations",
        "to": "finalize_tests",
        "condition": "FEATURE_COMPLETE",
        "description": "Feature complete, finalize tests for library"
      },
      {
        "from": "validate_expectations",
        "to": "implement_feature",
        "condition": "NEEDS_REFINEMENT",
        "description": "Minor issues, refine implementation"
      },
      {
        "from": "validate_expectations",
        "to": "plan_implementation",
        "condition": "INCOMPLETE",
        "description": "Significant gaps, revise implementation plan"
      },
      {
        "from": "validate_expectations",
        "to": "plan_tests",
        "condition": "NEEDS_MORE_TESTING",
        "description": "Insufficient test coverage, improve test plan"
      },
      {
        "from": "finalize_tests",
        "to": "collect_tests_to_library",
        "condition": "tests_finalized",
        "description": "Tests finalized, collect to library"
      },
      {
        "from": "collect_tests_to_library",
        "to": null,
        "condition": "tests_collected_and_committed",
        "description": "Tests collected and committed - PIPELINE ENDS"
      },
      {
        "from": "collect_tests_to_library",
        "to": null,
        "condition": "no_tests_found",
        "description": "No tests to collect - PIPELINE ENDS"
      },
      {
        "from": "collect_tests_to_library",
        "to": null,
        "condition": "all_tests_invalid",
        "description": "All tests invalid - PIPELINE ENDS"
      }
    ]
  },
  "metadata": {
    "tags": ["feature-development", "test-first", "validation", "unbiased"],
    "author": "Claude Plus Development System",
    "usesWindowsCommands": true,
    "requiresBrowser": true,
    "methodology": "Test-first with separation of concerns to prevent bias"
  }
}
